[![Build status](https://ci.appveyor.com/api/projects/status/c3oxe4mrxd8spjn2/branch/master?svg=true)](https://ci.appveyor.com/project/MortenHoustonLudvigsen/ts-css-loader/branch/master) [![Build Status](https://travis-ci.org/MortenHoustonLudvigsen/ts-css-loader.svg?branch=master)](https://travis-ci.org/MortenHoustonLudvigsen/ts-css-loader)
# ts-css-loader

**_This package is not ready for use_**

Create [TypeScript](http://www.typescriptlang.org/) typings for [CSS Modules](https://github.com/css-modules/css-modules) generated using [css-loader](https://github.com/webpack-contrib/css-loader) in [webpack](https://webpack.js.org/) for use with [ts-loader](https://github.com/TypeStrong/ts-loader).

## Installation

```
npm install ts-css-loader
```

You will also need to install [TypeScript](http://www.typescriptlang.org/) and [ts-loader](https://github.com/TypeStrong/ts-loader) if you have not already.

```
npm install typescript ts-loader
```

## Example

The following example webpack configuration provides typings for modules ending with `.css`. The `test` option for [css-loader](https://github.com/webpack-contrib/css-loader) should match the `test` option for `ts-css-loader`.

Note that there must be a rule using [css-loader](https://github.com/webpack-contrib/css-loader), which loads the css modules, that `ts-css-loader` comes **_after_** [ts-loader](https://github.com/TypeStrong/ts-loader), and that [ts-loader](https://github.com/TypeStrong/ts-loader) **_must_** be configured with `usePreviousLoaderGeneratedFiles: true`.

```js
module.exports = {
  ...
  module: {
    rules: [
      {
        test: /\.css$/,
        use: [
          {
            loader: 'css-loader',
            options: { modules: true, camelCase: true }
          }
        ]
      },
      {
        test: /\.tsx?$/,
        use: [
          {
            loader: 'ts-loader',
            options: { usePreviousLoaderGeneratedFiles: true }
          },
          {
            loader: 'ts-css-loader',
            options: { test: /\.css$/ }
          }
        ]
      }
    ]
  },
  ...
};
```

To make the typings generated by `ts-css-loader` available to other tools (f.ex. `tsc`) they can be saved as `.d.ts` files:

```js
{
  loader: 'ts-css-loader',
  options: { test: /\.css$/, save: true }
}
```

With the configution above, and given a file `Game.css`:

```css
.game {
    display: flex;
    flex-direction: row;
}

.game-info {
    margin-left: 20px;
}

.game-footer {
    margin-top: 20px;
}
```

... typings like the following will be generated by `ts-css-loader` and be available to [ts-loader](https://github.com/TypeStrong/ts-loader):

```typescript
// Default object containing all local CSS classes
declare const __styles: {
    "game": string;
    "game-info": string;
    "gameInfo": string;
    "game-footer": string;
    "gameFooter": string;
};
export default __styles;

// Named exports with local CSS classes whose names are valid identifiers
export const game: string;
export const gameInfo: string;
export const gameFooter: string;
```

If the option `save` is `true` these typings will also be saved to file `Game.css.d.ts`.

It is now possible to import `Game.css` in [TypeScript](http://www.typescriptlang.org/):

```typescript
import * as css from './Game.css';

const html = `<div class="${css.game}"></div>`;
```

## Options

### test _(RegExp) (default=/\.css$/)_

Specifies which modules to generate typings for. This should match the `test` option for [css-loader](https://github.com/webpack-contrib/css-loader).

### save _(boolean) (default=false)_

Specifies whether to save the generated typings to disk. If true, the typings will be saved to a file with `".d.ts"` appended to the file path of the imported module. So the typings for `Game.css` will be saved in file `Game.css.d.ts`.

This makes the typings available to other tools, f.ex. `tsc`.

### compiler _(string) (default='typescript')_

Allows use of TypeScript compilers other than the official one. Should be set to the NPM name of the compiler, eg [`ntypescript`](https://github.com/basarat/ntypescript).


## Developement

First, install dependent packages:

```
npm install
```

To build the project:

```
npm run build
```

### Testing

At the moment there are two simple test projects:

* `./test/tests/basic`
* `./test/tests/save-dts-files`

To run webpack on these test projects:

```
npm test
```
